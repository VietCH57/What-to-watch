{% extends "base.html" %}

{% block title %}Movie Preferences - What to Watch{% endblock %}

{% block content %}
<div class="container preferences-container"> 
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-body">
                    <h2 class="card-title text-center mb-4">Your Movie Preferences</h2>
                    
                    {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                            {% for category, message in messages %}
                                {% if category in ['success', 'preferences-success', 'preferences-error'] %}  <!-- Only show preferences-related messages -->
                                    <div class="alert alert-{{ category }}" role="alert">
                                        {{ message }}
                                    </div>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    {% endwith %}

                    <form action="{{ url_for('preferences') }}" method="post">
                        <!-- Genres Section -->
                        <div class="preference-section mb-4">
                            <h4>Favorite Genres</h4>
                            <div class="genre-grid">
                                {% for genre in ['Action', 'Adventure', 'Animation', 'Comedy', 'Crime', 'Documentary', 'Drama', 'Family', 'Fantasy', 'Horror', 'Mystery', 'Romance', 'Sci-Fi', 'Thriller'] %}
                                <div class="genre-item">
                                    <input type="checkbox" class="btn-check" name="genres" id="{{ genre|lower }}" value="{{ genre }}">
                                    <label class="btn btn-outline-primary" for="{{ genre|lower }}">{{ genre }}</label>
                                </div>
                                {% endfor %}
                            </div>
                        </div>

                        <!-- Rating Range -->
                        <div class="preference-section mb-4">
                            <h4>Minimum Rating</h4>
                            <div class="rating-slider">
                                <input type="range" class="form-range" min="1" max="10" step="0.5" id="rating" name="rating" value="5.0">
                                <div class="rating-value">Rating: <span id="ratingValue">5.0</span></div>
                            </div>
                        </div>

                        <!-- Release Year Range -->
                        <div class="preference-section mb-4">
                            <h4>Release Year Range</h4>
                            <div class="row">
                                <div class="col-6">
                                    <label for="yearFrom">From</label>
                                    <select class="form-select" id="yearFrom" name="yearFrom">
                                        {% for year in range(2024, 1899, -1) %}
                                        <option value="{{ year }}">{{ year }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-6">
                                    <label for="yearTo">To</label>
                                    <select class="form-select" id="yearTo" name="yearTo">
                                        {% for year in range(2024, 1899, -1) %}
                                        <option value="{{ year }}" {% if year == 2024 %}selected{% endif %}>{{ year }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Language Preference -->
                        <div class="preference-section mb-4">
                            <h4>Preferred Languages</h4>
                            <select class="form-select" multiple name="languages" id="languages">
                                <option value="en">English</option>
                                <option value="es">Spanish</option>
                                <option value="fr">French</option>
                                <option value="de">German</option>
                                <option value="it">Italian</option>
                                <option value="ja">Japanese</option>
                                <option value="ko">Korean</option>
                                <option value="zh">Chinese</option>
                            </select>
                        </div>

                        <!-- Submit Button -->
                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-primary btn-lg">
                                Get Recommendations
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Update rating value display
    document.getElementById('rating').addEventListener('input', function() {
        document.getElementById('ratingValue').textContent = this.value;
    });
</script>
{% endblock %}